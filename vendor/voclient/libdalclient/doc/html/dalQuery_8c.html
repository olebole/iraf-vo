<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>DAL Client Library: dalQuery.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>dalQuery.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;ctype.h&gt;</code><br>
<code>#include &lt;float.h&gt;</code><br>
<code>#include &quot;dalclient.h&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ae448d0ff2af9182dc4401a9e440e707"></a><!-- doxytag: member="dalQuery.c::dal_openConnection" ref="ae448d0ff2af9182dc4401a9e440e707" args="(char *baseurl, char *protocol, char *version)" -->
DAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_openConnection</b> (char *baseurl, char *protocol, char *version)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e215e60d4a55c17843621db9fd395aa9"></a><!-- doxytag: member="dalQuery.c::dal_openConeConnection" ref="e215e60d4a55c17843621db9fd395aa9" args="(char *baseurl, char *version)" -->
DAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_openConeConnection</b> (char *baseurl, char *version)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="98ac60b2ef677cd4406b6f91293a3e0f"></a><!-- doxytag: member="dalQuery.c::dal_openSiapConnection" ref="98ac60b2ef677cd4406b6f91293a3e0f" args="(char *baseurl, char *version)" -->
DAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_openSiapConnection</b> (char *baseurl, char *version)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f0d4e73550e8edb6ed2b13491806c7ac"></a><!-- doxytag: member="dalQuery.c::dal_openSsapConnection" ref="f0d4e73550e8edb6ed2b13491806c7ac" args="(char *baseurl, char *version)" -->
DAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_openSsapConnection</b> (char *baseurl, char *version)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6599dfbf1c661457e646b3fee48fb435"></a><!-- doxytag: member="dalQuery.c::dal_closeConnection" ref="6599dfbf1c661457e646b3fee48fb435" args="(DAL dal_h)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_closeConnection</b> (DAL dal_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0b1f723a75853ea1225b8a76457097dc"></a><!-- doxytag: member="dalQuery.c::dal_setBaseUrl" ref="0b1f723a75853ea1225b8a76457097dc" args="(DAL dal_h, char *base_url)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_setBaseUrl</b> (DAL dal_h, char *base_url)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e1b447ab9b60a7223b79182bad017c15"></a><!-- doxytag: member="dalQuery.c::dal_getBaseUrl" ref="e1b447ab9b60a7223b79182bad017c15" args="(DAL dal_h)" -->
char *&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getBaseUrl</b> (DAL dal_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6d275d41413539a9d0639face46550be"></a><!-- doxytag: member="dalQuery.c::dal_getQuery" ref="6d275d41413539a9d0639face46550be" args="(DAL dal_h)" -->
Query&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getQuery</b> (DAL dal_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="49c22edd74f63ea13ba40e94463f913a"></a><!-- doxytag: member="dalQuery.c::dal_closeQuery" ref="49c22edd74f63ea13ba40e94463f913a" args="(Query query_h)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_closeQuery</b> (Query query_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="613b713fe19317ecfe04e38183705b5e"></a><!-- doxytag: member="dalQuery.c::dal_getConeQuery" ref="613b713fe19317ecfe04e38183705b5e" args="(DAL dal_h, double ra, double dec, double sr)" -->
Query&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getConeQuery</b> (DAL dal_h, double ra, double dec, double sr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="93ede9c3c1f64b7b00c8feef8c8c5e1c"></a><!-- doxytag: member="dalQuery.c::dal_getSiapQuery" ref="93ede9c3c1f64b7b00c8feef8c8c5e1c" args="(DAL dal_h, double ra, double dec, double ra_size, double dec_size, char *format)" -->
Query&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getSiapQuery</b> (DAL dal_h, double ra, double dec, double ra_size, double dec_size, char *format)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3211b77dae86cc0336c776b33dc56c72"></a><!-- doxytag: member="dalQuery.c::dal_getSsapQuery" ref="3211b77dae86cc0336c776b33dc56c72" args="(DAL dal_h, double ra, double dec, double size, char *band, char *time, char *format)" -->
Query&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getSsapQuery</b> (DAL dal_h, double ra, double dec, double size, char *band, char *time, char *format)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f274202b97d6a015e63662d9ad1f3e37"></a><!-- doxytag: member="dalQuery.c::dal_getAccessDataQuery" ref="f274202b97d6a015e63662d9ad1f3e37" args="(DAL dal_h)" -->
Query&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getAccessDataQuery</b> (DAL dal_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3c684eb32f0d273f4e6c1ed9d2265201"></a><!-- doxytag: member="dalQuery.c::dal_getParamCount" ref="3c684eb32f0d273f4e6c1ed9d2265201" args="(Query query_h)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getParamCount</b> (Query query_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5086e7625a0f95a1dffa1e8733deaa9b"></a><!-- doxytag: member="dalQuery.c::dal_getParamName" ref="5086e7625a0f95a1dffa1e8733deaa9b" args="(Query query_h, int index)" -->
char *&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getParamName</b> (Query query_h, int index)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c9dd7eded8a99b8e90450addce135053"></a><!-- doxytag: member="dalQuery.c::dal_addIntParam" ref="c9dd7eded8a99b8e90450addce135053" args="(Query query_h, char *pname, long value)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_addIntParam</b> (Query query_h, char *pname, long value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4527b6ba84b5555f6afb1cabe6213fa7"></a><!-- doxytag: member="dalQuery.c::dal_addFloatParam" ref="4527b6ba84b5555f6afb1cabe6213fa7" args="(Query query_h, char *pname, double value)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_addFloatParam</b> (Query query_h, char *pname, double value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7e02460872b8b19fed3ca0f1a4b5db8a"></a><!-- doxytag: member="dalQuery.c::dal_addStringParam" ref="7e02460872b8b19fed3ca0f1a4b5db8a" args="(Query query_h, char *pname, char *value)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_addStringParam</b> (Query query_h, char *pname, char *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d71556c3f247604cf19ca81378df851f"></a><!-- doxytag: member="dalQuery.c::dal_setParam" ref="d71556c3f247604cf19ca81378df851f" args="(Query query_h, char *pname, char *value)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_setParam</b> (Query query_h, char *pname, char *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="32bf50613a213bdd66d0451a8515d86a"></a><!-- doxytag: member="dalQuery.c::dal_getParam" ref="32bf50613a213bdd66d0451a8515d86a" args="(Query query_h, char *pname, int index)" -->
char *&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getParam</b> (Query query_h, char *pname, int index)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5b5fea1ff4f472a4b105831267dd8967"></a><!-- doxytag: member="dalQuery.c::dal_delParam" ref="5b5fea1ff4f472a4b105831267dd8967" args="(Query query_h, char *pname)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_delParam</b> (Query query_h, char *pname)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a577b89c5273c6ad84d7c0bc86bce814"></a><!-- doxytag: member="dalQuery.c::dal_getQueryURL" ref="a577b89c5273c6ad84d7c0bc86bce814" args="(Query query_h)" -->
char *&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getQueryURL</b> (Query query_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6ef5612d6ebc25301018b6d823d16584"></a><!-- doxytag: member="dalQuery.c::dal_getError" ref="6ef5612d6ebc25301018b6d823d16584" args="(DAL dal_h)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getError</b> (DAL dal_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d9c2a00588cb9cd374dee93b54fdfdaa"></a><!-- doxytag: member="dalQuery.c::dal_getErrorMsg" ref="d9c2a00588cb9cd374dee93b54fdfdaa" args="(DAL dal_h)" -->
char *&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_getErrorMsg</b> (DAL dal_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2dd934b66a2adb2fd0e8a2e9c5e92bb1"></a><!-- doxytag: member="dalQuery.c::dal_clearError" ref="2dd934b66a2adb2fd0e8a2e9c5e92bb1" args="(DAL dal_h)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>dal_clearError</b> (DAL dal_h)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dalQuery_8c.html#e0708e2a6ca72c22c8d5aec42e3eea56">dal_error</a> (dalConn_t *dal, int errcode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dalQuery_8c.html#b472375e52c28fed7e4461072d1f41fd">dal_setErrorMsg</a> (dalConn_t *dal, char *errmsg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dalQuery_8c.html#c7a9ae9bd250b14f1e43552a1bcb5a82">dal_nError</a> (dalConn_t *dal, int errcode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dalQuery_8c.html#270da81a2191e86e0f01a24c0d2acd0a">dal_qError</a> (dalQuery_t *query, int errcode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dalQuery_8c.html#3e73a387cd144d587cc0886375a5db1f">dal_qrError</a> (dalQR_t *qr, int errcode)</td></tr>

</table>
<hr><h2>Detailed Description</h2>
DALQUERY -- Compose a query to a VO Data Access Layer (DAL) Service.<p>
These routines are used to create a DALClient context to be used to query a DAL service, and then compose the query.<p>
---- Service Connection ---------<p>
dal = dal_openConnection (baseurl, protocol, version) dal = dal_openConeConnection (baseurl, version) dal = dal_openSiapConnection (baseurl, version) dal = dal_openSsapConnection (baseurl, version) dal_closeConnection (dal)<p>
dal_setBaseUrl (dal, url) # setters/getters url = dal_getBaseUrl (dal)<p>
errcode = dal_getError (dal) dal_clearError (dal)<p>
---- Query Parameters ---------<p>
query = dal_getQuery (dal) dal_closeQuery (query) # free resources<p>
query = dal_getConeQuery (dal, ra, dec, sr) query = dal_getSiapQuery (dal, ra, dec, ra_size, dec_size, format) query = dal_getSsapQuery (dal, ra, dec, size, band, time, format)<p>
query = dal_genConeQuery (dal, pos) query = dal_genSiapQuery (dal, pos, band, time, pol, format, mode) query = dal_genSsapQuery (dal, pos, band, time, pol, format, mode)<p>
pos = dal_getObjPos (objname|NULL) pos = dal_setPos (c1, c2, size, frame|NULL) pos = dal_setPos2 (c1, c2, size1, size2, frame|NULL) &lt;additional-constructors&gt; &lt;additional-setters&gt; dal_posGetCoords (pos, c1, c2, &amp;frame) dal_closePos (pos)<p>
int = dal_getParamCount (query) str = dal_getParamName (query, index) stat = dal_addIntParam (query, pname, ival) stat = dal_addFloatParam (query, pname, dval) stat = dal_addStringParam (query, pname, str) dal_setParam (query, pname, str) str = dal_getParam (query, pname, index) dal_delParam (query, pname)<p>
str = dal_getQueryURL (query)<p>
A separate connection is required for each service to be queried. Simple queries may be composed directly via a service class-specific constructor, or queries may be built up with parameters, or both.<p>
All public routines in this interface that return an object handle, e.g., for a Dal or Query object, return an opaque object handle (not a normal C object pointer).<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Doug Tody </dd></dl>
<dl class="version" compact><dt><b>Version:</b></dt><dd>January 2014 </dd></dl>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="e0708e2a6ca72c22c8d5aec42e3eea56"></a><!-- doxytag: member="dalQuery.c::dal_error" ref="e0708e2a6ca72c22c8d5aec42e3eea56" args="(dalConn_t *dal, int errcode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dal_error           </td>
          <td>(</td>
          <td class="paramtype">dalConn_t *&nbsp;</td>
          <td class="paramname"> <em>dal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errcode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
dal_error -- Post an error for the connection.<p>
The given error code is stored in the DAL connection context for later retrieval. The error status is saved until explicitly cleared. DAL_ERROR is returned as the status value, allowing the error status to be posted within a return statement. 
<p>Referenced by <a class="el" href="dalQuery_8c_source.html#l01061">dal_qError()</a>, and <a class="el" href="dalQuery_8c_source.html#l01073">dal_qrError()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c7a9ae9bd250b14f1e43552a1bcb5a82"></a><!-- doxytag: member="dalQuery.c::dal_nError" ref="c7a9ae9bd250b14f1e43552a1bcb5a82" args="(dalConn_t *dal, int errcode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* dal_nError           </td>
          <td>(</td>
          <td class="paramtype">dalConn_t *&nbsp;</td>
          <td class="paramname"> <em>dal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errcode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
dal_nError -- Post an error for the connection, returning NULL. NULL is returned as the status value, allowing the error status to be posted within a return statement. 
</div>
</div><p>
<a class="anchor" name="270da81a2191e86e0f01a24c0d2acd0a"></a><!-- doxytag: member="dalQuery.c::dal_qError" ref="270da81a2191e86e0f01a24c0d2acd0a" args="(dalQuery_t *query, int errcode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dal_qError           </td>
          <td>(</td>
          <td class="paramtype">dalQuery_t *&nbsp;</td>
          <td class="paramname"> <em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errcode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
dal_qError -- Convenience routine for posting an error within the query construction code. 
<p>References <a class="el" href="dalQuery_8c_source.html#l01025">dal_error()</a>.</p>

</div>
</div><p>
<a class="anchor" name="3e73a387cd144d587cc0886375a5db1f"></a><!-- doxytag: member="dalQuery.c::dal_qrError" ref="3e73a387cd144d587cc0886375a5db1f" args="(dalQR_t *qr, int errcode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dal_qrError           </td>
          <td>(</td>
          <td class="paramtype">dalQR_t *&nbsp;</td>
          <td class="paramname"> <em>qr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errcode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
dal_qrError -- Convenience routine for posting an error within the query response code. 
<p>References <a class="el" href="dalQuery_8c_source.html#l01025">dal_error()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b472375e52c28fed7e4461072d1f41fd"></a><!-- doxytag: member="dalQuery.c::dal_setErrorMsg" ref="b472375e52c28fed7e4461072d1f41fd" args="(dalConn_t *dal, char *errmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dal_setErrorMsg           </td>
          <td>(</td>
          <td class="paramtype">dalConn_t *&nbsp;</td>
          <td class="paramname"> <em>dal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>errmsg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
dal_setErrorMsg -- Set the error message string. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Sep 23 09:21:35 2014 for DAL Client Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
